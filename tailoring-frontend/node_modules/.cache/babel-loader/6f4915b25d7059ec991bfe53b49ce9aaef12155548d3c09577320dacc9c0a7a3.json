{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import ChatPanel from\"../components/ChatPanel\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function SellerChatsPage(_ref){var _profile$seller,_profile$seller2;let{profile}=_ref;const sellerId=(profile===null||profile===void 0?void 0:(_profile$seller=profile.seller)===null||_profile$seller===void 0?void 0:_profile$seller.id)||(profile===null||profile===void 0?void 0:profile.id);const[chats,setChats]=useState([]);const[selectedCustomer,setSelectedCustomer]=useState(null);useEffect(()=>{if(!sellerId)return;async function fetchChats(){try{const res=await fetch(\"http://localhost:8000/api/seller_chats/\".concat(sellerId));if(res.ok){const data=await res.json();setChats(data);}else{setChats([]);}}catch(e){setChats([]);}}fetchChats();},[sellerId]);if(!sellerId){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:\"Loading seller info...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-72 bg-white border-r\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold p-4 text-green-700\",children:\"User chats\"}),/*#__PURE__*/_jsx(\"ul\",{children:chats.length===0?/*#__PURE__*/_jsx(\"li\",{className:\"p-4 text-gray-400\",children:\"No chats yet\"}):chats.map(c=>/*#__PURE__*/_jsxs(\"li\",{className:\"p-4 cursor-pointer hover:bg-green-100 \".concat((selectedCustomer===null||selectedCustomer===void 0?void 0:selectedCustomer.id)===c.customer_id?\"bg-green-200\":\"\"),onClick:()=>setSelectedCustomer({id:c.customer_id,name:c.customer_name}),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:c.customer_name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 truncate\",children:c.last_message})]},c.customer_id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex flex-col items-center justify-center\",children:selectedCustomer?/*#__PURE__*/_jsx(ChatPanel,{userId:sellerId,otherId:selectedCustomer.id,userRoleId:2,otherRoleId:1,senderName:(profile===null||profile===void 0?void 0:(_profile$seller2=profile.seller)===null||_profile$seller2===void 0?void 0:_profile$seller2.shop_name)||(profile===null||profile===void 0?void 0:profile.name),receiverName:selectedCustomer.name}):/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400\",children:\"Select a customer\"})})]});}","map":{"version":3,"names":["React","useEffect","useState","ChatPanel","jsx","_jsx","jsxs","_jsxs","SellerChatsPage","_ref","_profile$seller","_profile$seller2","profile","sellerId","seller","id","chats","setChats","selectedCustomer","setSelectedCustomer","fetchChats","res","fetch","concat","ok","data","json","e","className","children","length","map","c","customer_id","onClick","name","customer_name","last_message","userId","otherId","userRoleId","otherRoleId","senderName","shop_name","receiverName"],"sources":["C:/Users/admin/SheStich/tailoring-frontend/src/pages/SellerChatsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport ChatPanel from \"../components/ChatPanel\";\r\n\r\nexport default function SellerChatsPage({ profile }) {\r\n  const sellerId = profile?.seller?.id || profile?.id;\r\n  const [chats, setChats] = useState([]);\r\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!sellerId) return;\r\n    async function fetchChats() {\r\n      try {\r\n        const res = await fetch(`http://localhost:8000/api/seller_chats/${sellerId}`);\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          setChats(data);\r\n        } else {\r\n          setChats([]);\r\n        }\r\n      } catch (e) {\r\n        setChats([]);\r\n      }\r\n    }\r\n    fetchChats();\r\n  }, [sellerId]);\r\n\r\n  if (!sellerId) {\r\n    return <div className=\"flex items-center justify-center min-h-screen\">Loading seller info...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen\">\r\n      {/* Left sidebar: Customer list */}\r\n      <div className=\"w-72 bg-white border-r\">\r\n        <div className=\"font-bold p-4 text-green-700\">User chats</div>\r\n        <ul>\r\n          {chats.length === 0 ? (\r\n            <li className=\"p-4 text-gray-400\">No chats yet</li>\r\n          ) : (\r\n            chats.map(c => (\r\n              <li\r\n                key={c.customer_id}\r\n                className={`p-4 cursor-pointer hover:bg-green-100 ${\r\n                  selectedCustomer?.id === c.customer_id ? \"bg-green-200\" : \"\"\r\n                }`}\r\n                onClick={() => setSelectedCustomer({ id: c.customer_id, name: c.customer_name })}\r\n              >\r\n                <div className=\"font-semibold\">{c.customer_name}</div>\r\n                <div className=\"text-xs text-gray-500 truncate\">{c.last_message}</div>\r\n              </li>\r\n            ))\r\n          )}\r\n        </ul>\r\n      </div>\r\n      {/* Main panel: Chat */}\r\n      <div className=\"flex-1 flex flex-col items-center justify-center\">\r\n        {selectedCustomer ? (\r\n          <ChatPanel\r\n            userId={sellerId}\r\n            otherId={selectedCustomer.id}\r\n            userRoleId={2}\r\n            otherRoleId={1}\r\n            senderName={profile?.seller?.shop_name || profile?.name}\r\n            receiverName={selectedCustomer.name}\r\n          />\r\n        ) : (\r\n          <div className=\"text-gray-400\">Select a customer</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}