{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate}from\"react-router-dom\";import Home from\"./pages/Home\";import SellerDashboard from\"./pages/SellerDashboard\";import CustomerDashboard from\"./pages/CustomerDashboard\";import ChatPage from\"./pages/ChatPage\";import Login from\"./pages/Login\";import Register from\"./pages/Register\";import SellerListPage from\"./pages/SellerListPage\";import SellerChatsPage from\"./pages/SellerChatsPage\";// <-- NEW: Seller's chat list page\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[profile,setProfile]=useState(null);const[sellers,setSellers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");// Restore profile from localStorage on first load (so dashboards work after refresh)\nuseEffect(()=>{if(!profile){const stored=localStorage.getItem(\"userProfile\");if(stored){setProfile(JSON.parse(stored));}}},[profile]);useEffect(()=>{async function fetchSellers(){setLoading(true);setError(\"\");try{// Use your real API endpoint here\nconst res=await fetch(\"http://localhost:8000/api/sellers\");if(!res.ok){throw new Error(\"Failed to fetch sellers\");}const data=await res.json();// Normalize seller data\nconst normalized=data.map(seller=>({id:seller.id,fullName:seller.full_name||seller.fullName,tailoringName:seller.shop_name||seller.tailoringName,phone:seller.phone_number||seller.phone,address:seller.shop_address||seller.address,email:seller.email,photoUrl:seller.photo_url||seller.photoUrl,gstNumber:seller.gst_number||seller.gstNumber,designs:Array.isArray(seller.portfolios)?seller.portfolios.map(design=>({imageUrl:design.image_url,title:design.title,description:design.description,contact:design.contact})):[]}));setSellers(normalized);}catch(err){setError(\"Unable to load sellers. Please try again later.\");setSellers([]);}setLoading(false);}fetchSellers();},[]);return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-50 via-green-50 to-blue-100 animate-bgMove\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Login,{setProfile:setProfile})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{setProfile:setProfile})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(Home,{profile:profile})}),/*#__PURE__*/_jsx(Route,{path:\"/seller\",element:/*#__PURE__*/_jsx(SellerDashboard,{profile:profile,setProfile:setProfile})}),/*#__PURE__*/_jsx(Route,{path:\"/seller/chats\",element:/*#__PURE__*/_jsx(SellerChatsPage,{profile:profile})}),/*#__PURE__*/_jsx(Route,{path:\"/customer\",element:loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen text-xl\",children:\"Loading sellers...\"}):error?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen text-xl text-red-600\",children:error}):/*#__PURE__*/_jsx(SellerListPage,{sellers:sellers})}),/*#__PURE__*/_jsx(Route,{path:\"/customer/:sellerId\",element:loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen text-xl\",children:\"Loading seller details...\"}):error?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen text-xl text-red-600\",children:error}):/*#__PURE__*/_jsx(CustomerDashboard,{sellers:sellers,userProfile:profile})}),/*#__PURE__*/_jsx(Route,{path:\"/chat/:userRole/:userId/:otherId\",element:/*#__PURE__*/_jsx(ChatPage,{profile:profile})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(ChatPage,{profile:profile})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","Home","SellerDashboard","CustomerDashboard","ChatPage","Login","Register","SellerListPage","SellerChatsPage","jsx","_jsx","jsxs","_jsxs","App","profile","setProfile","sellers","setSellers","loading","setLoading","error","setError","stored","localStorage","getItem","JSON","parse","fetchSellers","res","fetch","ok","Error","data","json","normalized","map","seller","id","fullName","full_name","tailoringName","shop_name","phone","phone_number","address","shop_address","email","photoUrl","photo_url","gstNumber","gst_number","designs","Array","isArray","portfolios","design","imageUrl","image_url","title","description","contact","err","children","className","path","element","userProfile","to"],"sources":["C:/Users/admin/SheStich/tailoring-frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n  Navigate,\n} from \"react-router-dom\";\nimport Home from \"./pages/Home\";\nimport SellerDashboard from \"./pages/SellerDashboard\";\nimport CustomerDashboard from \"./pages/CustomerDashboard\";\nimport ChatPage from \"./pages/ChatPage\";\nimport Login from \"./pages/Login\";\nimport Register from \"./pages/Register\";\nimport SellerListPage from \"./pages/SellerListPage\";\nimport SellerChatsPage from \"./pages/SellerChatsPage\"; // <-- NEW: Seller's chat list page\n\nfunction App() {\n  const [profile, setProfile] = useState(null);\n  const [sellers, setSellers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  // Restore profile from localStorage on first load (so dashboards work after refresh)\n  useEffect(() => {\n    if (!profile) {\n      const stored = localStorage.getItem(\"userProfile\");\n      if (stored) {\n        setProfile(JSON.parse(stored));\n      }\n    }\n  }, [profile]);\n\n  useEffect(() => {\n    async function fetchSellers() {\n      setLoading(true);\n      setError(\"\");\n      try {\n        // Use your real API endpoint here\n        const res = await fetch(\"http://localhost:8000/api/sellers\");\n        if (!res.ok) {\n          throw new Error(\"Failed to fetch sellers\");\n        }\n        const data = await res.json();\n        // Normalize seller data\n        const normalized = data.map(seller => ({\n          id: seller.id,\n          fullName: seller.full_name || seller.fullName,\n          tailoringName: seller.shop_name || seller.tailoringName,\n          phone: seller.phone_number || seller.phone,\n          address: seller.shop_address || seller.address,\n          email: seller.email,\n          photoUrl: seller.photo_url || seller.photoUrl,\n          gstNumber: seller.gst_number || seller.gstNumber,\n          designs: Array.isArray(seller.portfolios)\n            ? seller.portfolios.map(design => ({\n                imageUrl: design.image_url,\n                title: design.title,\n                description: design.description,\n                contact: design.contact,\n              }))\n            : [],\n        }));\n        setSellers(normalized);\n      } catch (err) {\n        setError(\"Unable to load sellers. Please try again later.\");\n        setSellers([]);\n      }\n      setLoading(false);\n    }\n    fetchSellers();\n  }, []);\n\n  return (\n    <Router>\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-green-50 to-blue-100 animate-bgMove\">\n        <Routes>\n          <Route path=\"/\" element={<Login setProfile={setProfile} />} />\n          <Route path=\"/login\" element={<Login setProfile={setProfile} />} />\n          <Route path=\"/register\" element={<Register />} />\n          <Route path=\"/home\" element={<Home profile={profile} />} />\n          <Route path=\"/seller\" element={\n            <SellerDashboard\n              profile={profile}\n              setProfile={setProfile}\n            />\n          } />\n          {/* Seller's chat list page with left-side customer list */}\n          <Route\n            path=\"/seller/chats\"\n            element={<SellerChatsPage profile={profile} />}\n          />\n          <Route path=\"/customer\" element={\n            loading ? (\n              <div className=\"flex items-center justify-center min-h-screen text-xl\">Loading sellers...</div>\n            ) : error ? (\n              <div className=\"flex items-center justify-center min-h-screen text-xl text-red-600\">{error}</div>\n            ) : (\n              <SellerListPage sellers={sellers} />\n            )\n          } />\n          <Route path=\"/customer/:sellerId\" element={\n            loading ? (\n              <div className=\"flex items-center justify-center min-h-screen text-xl\">Loading seller details...</div>\n            ) : error ? (\n              <div className=\"flex items-center justify-center min-h-screen text-xl text-red-600\">{error}</div>\n            ) : (\n              <CustomerDashboard sellers={sellers} userProfile={profile} />\n            )\n          } />\n          {/* Full-screen chat for both roles, with params */}\n          <Route\n            path=\"/chat/:userRole/:userId/:otherId\"\n            element={<ChatPage profile={profile} />}\n          />\n          {/* Fallback: for old style /chat with query params (optional) */}\n          <Route path=\"/chat\" element={<ChatPage profile={profile} />} />\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}